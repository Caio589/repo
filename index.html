<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>PDV Barbearia</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:url("https://images.unsplash.com/photo-1503951914875-452162b0f3f1");background-size:cover;background-position:center}
.overlay{background:rgba(0,0,0,.72);min-height:100vh}
.menu{position:fixed;left:0;top:0;bottom:0;width:70px;background:rgba(0,0,0,.45);display:flex;flex-direction:column;align-items:center;padding-top:20px}
.menu button{background:none;border:none;color:#f1c40f;font-size:22px;margin:15px 0;cursor:pointer}
.content{margin-left:90px;padding:20px;color:#fff}
.section{display:none}.section.active{display:block}
input,select,button{padding:8px;border-radius:6px;border:none;margin:4px 0}
button{cursor:pointer;font-weight:bold}
.total{font-size:20px;color:#2ecc71}
.hidden{display:none}
table{width:100%;margin-top:10px}
th,td{padding:6px;text-align:left}
</style>
</head>

<body>
<div class="overlay">

<div class="menu">
  <button onclick="show('pdv')">ðŸ’ˆ</button>
  <button onclick="show('agenda')">ðŸ•’</button>
  <button onclick="show('clientes')">ðŸ‘¤</button>
  <button onclick="show('planos')">ðŸ’³</button>
  <button onclick="show('produtos')">ðŸ“¦</button>
  <button onclick="show('despesas')">ðŸ§¾</button>
  <button onclick="show('mensal')">ðŸ“†</button>
</div>

<div class="content">

<div id="pdv" class="section active">
  <h2>PDV / Caixa</h2>
  <p id="statusCaixa"></p>

  <div id="abrirBox">
    <input id="valorAbertura" type="number" placeholder="Valor de abertura">
    <button onclick="abrirCaixa()">Abrir Caixa</button>
  </div>

  <select id="cliente"></select>
  <select id="produto"></select>

  <select id="pagamento">
    <option value="dinheiro">Dinheiro</option>
    <option value="pix">Pix</option>
    <option value="cartao">CartÃ£o</option>
  </select>

  <input id="valorPago" type="number" placeholder="Valor pago (dinheiro)">
  <p id="trocoInfo"></p>

  <button onclick="addItem()">Adicionar</button>

  <table id="carrinho"></table>

  <p class="total">Total: R$ <span id="total">0.00</span></p>

  <button onclick="finalizarVenda()">Finalizar Venda</button>
  <button onclick="fecharCaixa()" style="background:#e74c3c;color:#fff">Fechar Caixa</button>

  <div id="resumoCaixa"></div>
</div>

<div id="agenda" class="section">
  <h2>Agenda</h2>
  <input type="date" id="dataAgenda">
  <select id="horaAgenda"></select>
  <select id="clienteAgenda"></select>
  <select id="servicoAgenda"></select>
  <button onclick="salvarAgendamento()">Agendar</button>
  <ul id="listaAgenda"></ul>
</div>

<div id="clientes" class="section">
  <h2>Clientes</h2>
  <input id="nomeCliente" placeholder="Nome">
  <select id="planoCliente"></select>
  <button onclick="salvarCliente()">Salvar</button>
  <ul id="listaClientes"></ul>
</div>

<div id="planos" class="section">
  <h2>Planos</h2>
  <input id="nomePlano" placeholder="Nome">
  <input id="valorPlano" type="number" placeholder="Valor">
  <input id="qtdPlano" type="number" placeholder="Qtd serviÃ§os">
  <select id="tipoPlano"></select>
  <button onclick="salvarPlano()">Salvar</button>
  <ul id="listaPlanos"></ul>
</div>

<div id="produtos" class="section">
  <h2>Produtos / ServiÃ§os</h2>
  <input id="nomeProd" placeholder="Nome">
  <input id="valorProd" type="number" placeholder="Valor">
  <select id="tipoProd">
    <option value="produto">Produto</option>
    <option value="servico">ServiÃ§o</option>
  </select>
  <button onclick="salvarProduto()">Salvar</button>
  <ul id="listaProdutos"></ul>
</div>

<div id="despesas" class="section">
  <h2>Despesas</h2>
  <input id="descDespesa" placeholder="DescriÃ§Ã£o">
  <input id="valorDespesa" type="number" placeholder="Valor">
  <button onclick="salvarDespesa()">Salvar</button>
  <ul id="listaDespesas"></ul>
</div>

<div id="mensal" class="section">
  <h2>RelatÃ³rio Mensal</h2>
  <input type="month" id="mesRelatorio">
  <button onclick="gerarRelatorioMensal()">Gerar</button>
  <div id="resumoMensal"></div>
</div>

</div>
</div>

<script>
function show(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

const db = JSON.parse(localStorage.getItem("db")) || {
  clientes:[], planos:[], produtos:[],
  vendas:[], despesas:[], agenda:[],
  caixa:{aberto:false,abertura:0,dinheiro:0,pix:0,cartao:0}
};

let carrinho=[];
function save(){localStorage.setItem("db",JSON.stringify(db))}

function abrirCaixa(){
  db.caixa.aberto=true;
  db.caixa.abertura=+valorAbertura.value||0;
  save(); render();
}

function addItem(){
  if(!produto.value) return;
  const [nome,valor]=produto.value.split("|");
  carrinho.push({nome,valor:+valor||0});
  renderCarrinho();
}

function finalizarVenda(){
  if(!db.caixa.aberto) return alert("Caixa fechado");
  if(carrinho.length===0) return alert("Carrinho vazio");

  const total=carrinho.reduce((s,i)=>s+i.valor,0);
  const pago=+valorPago.value||0;

  if(pagamento.value==="dinheiro"){
    if(pago<total) return alert("Valor insuficiente");
    db.caixa.dinheiro+=total;
    trocoInfo.innerText=`Troco: R$ ${(pago-total).toFixed(2)}`;
  }
  if(pagamento.value==="pix") db.caixa.pix+=total;
  if(pagamento.value==="cartao") db.caixa.cartao+=total;

  db.vendas.push({data:new Date().toLocaleString(),total});
  carrinho=[]; valorPago.value="";
  save(); render();
}

function fecharCaixa(){
  alert("Caixa fechado com sucesso");
  db.caixa.aberto=false;
  db.caixa.dinheiro=0;db.caixa.pix=0;db.caixa.cartao=0;
  save(); render();
}

function renderCarrinho(){
  let h="<tr><th>Item</th><th>Valor</th></tr>",s=0;
  carrinho.forEach(i=>{
    h+=`<tr><td>${i.nome}</td><td>R$ ${i.valor.toFixed(2)}</td></tr>`;
    s+=i.valor;
  });
  carrinho.innerHTML=h;
  total.innerText=s.toFixed(2);
}

function render(){
  statusCaixa.innerText=db.caixa.aberto?"ðŸŸ¢ Caixa aberto":"ðŸ”´ Caixa fechado";
  abrirBox.classList.toggle("hidden",db.caixa.aberto);

  cliente.innerHTML=db.clientes.map(c=>`<option>${c.nome}</option>`).join("");
  clienteAgenda.innerHTML=cliente.innerHTML;

  planoCliente.innerHTML=`<option value="">Sem plano</option>`+
    db.planos.map(p=>`<option>${p.nome}</option>`).join("");

  produto.innerHTML=db.produtos.map(p=>
    `<option value="${p.nome}|${p.valor}">${p.nome}</option>`
  ).join("");

  resumoCaixa.innerHTML=`
  <p>ðŸ’° Dinheiro: R$ ${db.caixa.dinheiro.toFixed(2)}</p>
  <p>ðŸ“² Pix: R$ ${db.caixa.pix.toFixed(2)}</p>
  <p>ðŸ’³ CartÃ£o: R$ ${db.caixa.cartao.toFixed(2)}</p>`;
}

render();
</script>

</body>
</html>
