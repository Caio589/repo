<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>PDV Barbearia</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:url("https://images.unsplash.com/photo-1503951914875-452162b0f3f1");background-size:cover;background-position:center}
.overlay{background:rgba(0,0,0,.75);min-height:100vh}
.menu{position:fixed;left:0;top:0;bottom:0;width:70px;background:rgba(0,0,0,.4);display:flex;flex-direction:column;align-items:center;padding-top:20px}
.menu button{background:none;border:none;color:#f1c40f;font-size:22px;margin:15px 0;cursor:pointer}
.content{margin-left:90px;padding:20px;color:#fff}
.section{display:none}.section.active{display:block}
input,select,button{padding:8px;border-radius:6px;border:none;margin:4px 0}
button{cursor:pointer;font-weight:bold}
.total{font-size:20px;color:#2ecc71}
.caixaAberto{color:#2ecc71;font-size:20px;font-weight:bold}
.hidden{display:none}
</style>
</head>

<body>
<div class="overlay">

<div class="menu">
  <button onclick="show('pdv')">ðŸ’ˆ</button>
  <button onclick="show('clientes')">ðŸ‘¤</button>
  <button onclick="show('produtos')">ðŸ“¦</button>
  <button onclick="show('despesas')">ðŸ§¾</button>
  <button onclick="show('historico')">ðŸ“š</button>
</div>

<div class="content">

<!-- PDV -->
<div id="pdv" class="section active">
  <h2>PDV / Caixa</h2>

  <p id="statusCaixa"></p>

  <div id="abrirBox">
    <input id="valorAbertura" type="number" placeholder="Valor de abertura">
    <button onclick="abrirCaixa()">Abrir Caixa</button>
  </div>

  <select id="pagamento">
    <option value="dinheiro">Dinheiro</option>
    <option value="pix">Pix</option>
    <option value="cartao">CartÃ£o</option>
  </select>

  <input id="itemNome" placeholder="Item">
  <input id="itemValor" type="number" placeholder="Valor">
  <button onclick="finalizarVenda()">Registrar Venda</button>

  <p class="total">Total do dia: R$ <span id="totalDia">0.00</span></p>

  <button onclick="fecharCaixa()">Fechar Caixa</button>
</div>

<!-- CLIENTES -->
<div id="clientes" class="section">
  <h2>Clientes</h2>
  <input id="nomeCliente" placeholder="Nome">
  <button onclick="salvarCliente()">Salvar</button>
  <ul id="listaClientes"></ul>
</div>

<!-- PRODUTOS -->
<div id="produtos" class="section">
  <h2>Produtos</h2>
  <input id="nomeProd" placeholder="Nome">
  <input id="valorProd" type="number" placeholder="Valor">
  <button onclick="salvarProduto()">Salvar</button>
  <ul id="listaProdutos"></ul>
</div>

<!-- DESPESAS -->
<div id="despesas" class="section">
  <h2>Despesas</h2>
  <input id="descDespesa" placeholder="DescriÃ§Ã£o">
  <input id="valorDespesa" type="number" placeholder="Valor">
  <button onclick="salvarDespesa()">Salvar</button>
  <ul id="listaDespesas"></ul>
</div>

<!-- HISTÃ“RICO -->
<div id="historico" class="section">
  <h2>HistÃ³rico de Caixa</h2>
  <ul id="listaHistorico"></ul>
</div>

</div>
</div>

<script>
function show(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

const db = JSON.parse(localStorage.getItem("db")) || {
  clientes:[], produtos:[], despesas:[], vendas:[],
  historico:[], caixa:{aberto:false,abertura:0}
};

function save(){localStorage.setItem("db",JSON.stringify(db))}

function abrirCaixa(){
  db.caixa.aberto = true;
  db.caixa.abertura = +valorAbertura.value || 0;
  db.vendas = [];
  save();
  render();
}

function finalizarVenda(){
  if(!db.caixa.aberto) return alert("Abra o caixa");
  const v = +itemValor.value || 0;
  db.vendas.push({valor:v, pagamento:pagamento.value});
  save();
  render();
}

function fecharCaixa(){
  const total = db.vendas.reduce((s,v)=>s+v.valor,0);
  db.historico.push({
    data:new Date().toLocaleString(),
    abertura:db.caixa.abertura,
    total
  });
  db.caixa.aberto = false;
  save();
  render();
}

function salvarCliente(){
  db.clientes.push({nome:nomeCliente.value});
  save(); render();
}
function salvarProduto(){
  db.produtos.push({nome:nomeProd.value,valor:+valorProd.value});
  save(); render();
}
function salvarDespesa(){
  db.despesas.push({desc:descDespesa.value,valor:+valorDespesa.value});
  save(); render();
}

function render(){
  statusCaixa.innerHTML = db.caixa.aberto
    ? '<span class="caixaAberto">ðŸŸ¢ CAIXA ABERTO</span>'
    : '<span>ðŸ”´ CAIXA FECHADO</span>';

  abrirBox.classList.toggle("hidden", db.caixa.aberto);

  totalDia.innerText = db.vendas.reduce((s,v)=>s+v.valor,0).toFixed(2);

  listaClientes.innerHTML = db.clientes.map(c=>`<li>${c.nome}</li>`).join("");
  listaProdutos.innerHTML = db.produtos.map(p=>`<li>${p.nome} - R$ ${p.valor}</li>`).join("");
  listaDespesas.innerHTML = db.despesas.map(d=>`<li>${d.desc} - R$ ${d.valor}</li>`).join("");

  listaHistorico.innerHTML = db.historico.map(h=>`
    <li>${h.data} | Abertura R$ ${h.abertura} | Total R$ ${h.total}</li>
  `).join("");
}

render();
</script>

</body>
</html>
